<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Fertility and Fiscal Space – Phi_K basic tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<link href="../../../../../../assets/osaa_logo_orange.png" rel="icon" type="image/png">
<script src="../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../../../assets/osaa_logo_white.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../briefing/briefing.html"> 
<span class="menu-text">Briefing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../article/article.html"> 
<span class="menu-text">Brief</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../dashboard/dashboard.html"> 
<span class="menu-text">Dashboard</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../explorer/explorer.html"> 
<span class="menu-text">Explorer</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-appendix" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Appendix</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-appendix">    
        <li>
    <a class="dropdown-item" href="../../../../../../appendix/eda_report.html">
 <span class="dropdown-text">EDA Report</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../appendix/data_yprofile.html">
 <span class="dropdown-text">Data Profile</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../appendix/data_table.html">
 <span class="dropdown-text">Data Table</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#take-a-first-look-at-the-data" id="toc-take-a-first-look-at-the-data" class="nav-link" data-scroll-target="#take-a-first-look-at-the-data">Take a first look at the data</a></li>
  <li><a href="#specify-bin-types" id="toc-specify-bin-types" class="nav-link" data-scroll-target="#specify-bin-types">Specify bin types</a></li>
  <li><a href="#visually-inspect-pairwise-correlations" id="toc-visually-inspect-pairwise-correlations" class="nav-link" data-scroll-target="#visually-inspect-pairwise-correlations">Visually inspect pairwise correlations</a>
  <ul class="collapse">
  <li><a href="#bin-the-interval-variables" id="toc-bin-the-interval-variables" class="nav-link" data-scroll-target="#bin-the-interval-variables">Bin the interval variables</a></li>
  </ul></li>
  <li><a href="#correlation-mileage-vs-car_size" id="toc-correlation-mileage-vs-car_size" class="nav-link" data-scroll-target="#correlation-mileage-vs-car_size">Correlation: mileage vs car_size</a></li>
  <li><a href="#phi_k-functions-for-dataframes" id="toc-phi_k-functions-for-dataframes" class="nav-link" data-scroll-target="#phi_k-functions-for-dataframes"><span class="math inline">\(\phi_k\)</span> functions for dataframes</a></li>
  <li><a href="#phi_k-correlation-matrix" id="toc-phi_k-correlation-matrix" class="nav-link" data-scroll-target="#phi_k-correlation-matrix"><span class="math inline">\(\phi_k\)</span> correlation matrix</a></li>
  <li><a href="#global-correlation-g_k" id="toc-global-correlation-g_k" class="nav-link" data-scroll-target="#global-correlation-g_k">Global correlation: <span class="math inline">\(g_k\)</span></a></li>
  <li><a href="#statistical-significance-of-the-correlation-z-score" id="toc-statistical-significance-of-the-correlation-z-score" class="nav-link" data-scroll-target="#statistical-significance-of-the-correlation-z-score">Statistical significance of the correlation: <span class="math inline">\(Z\)</span>-score</a></li>
  <li><a href="#outlier-significance" id="toc-outlier-significance" class="nav-link" data-scroll-target="#outlier-significance">Outlier significance</a>
  <ul class="collapse">
  <li><a href="#example-1-car_color-versus-area" id="toc-example-1-car_color-versus-area" class="nav-link" data-scroll-target="#example-1-car_color-versus-area">Example 1: car_color versus area</a></li>
  <li><a href="#example-2-mileage-versus-car_size" id="toc-example-2-mileage-versus-car_size" class="nav-link" data-scroll-target="#example-2-mileage-versus-car_size">Example 2: mileage versus car_size</a></li>
  </ul></li>
  <li><a href="#correlation-report" id="toc-correlation-report" class="nav-link" data-scroll-target="#correlation-report">Correlation report</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Phi_K basic tutorial</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This notebook guides you through the basic functionality of the phik package. The package offers functionality on three related topics:</p>
<ol type="1">
<li>Phik correlation matrix</li>
<li>Significance matrix</li>
<li>Outlier significance matrix</li>
</ol>
<p>For more information on the underlying theory, the user is referred to our paper.</p>
<div id="cell-2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>capture</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install phik (if not installed yet)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span><span class="st">"</span><span class="sc">{sys.executable}</span><span class="st">"</span> <span class="op">-</span>m pip install phik</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import standard packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> phik</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> phik <span class="im">import</span> resources</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> phik.binning <span class="im">import</span> bin_data</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> phik.report <span class="im">import</span> plot_correlation_matrix</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if one changes something in the phik-package one can automatically reload the package or module</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-data" class="level1">
<h1>Load data</h1>
<p>A simulated dataset is part of the phik-package. The dataset concerns fake car insurance data. Load the dataset here:</p>
<div id="cell-6" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv( resources.fixture(<span class="st">'fake_insurance_data.csv.gz'</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="take-a-first-look-at-the-data" class="level1">
<h1>Take a first look at the data</h1>
<p>Let’s use a simple data.head() to get an idea of what the data looks like and inspect the different types of variables.</p>
<div id="cell-9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th">driver_age</th>
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th">mileage</th>
<th data-quarto-table-cell-role="th">car_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>black</td>
<td>26.377219</td>
<td>suburbs</td>
<td>156806.288398</td>
<td>XXL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>black</td>
<td>58.976840</td>
<td>suburbs</td>
<td>74400.323559</td>
<td>XL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>multicolor</td>
<td>55.744988</td>
<td>downtown</td>
<td>267856.748015</td>
<td>XXL</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>metalic</td>
<td>57.629139</td>
<td>downtown</td>
<td>259028.249060</td>
<td>XXL</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>green</td>
<td>21.490637</td>
<td>downtown</td>
<td>110712.216080</td>
<td>XL</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="specify-bin-types" class="level1">
<h1>Specify bin types</h1>
<p>The phik-package offers a way to calculate correlations between variables of mixed types. Variable types can be inferred automatically although we recommend variable types to be specified by the user.</p>
<p>Because interval type variables need to be binned in order to calculate phik and the significance, a list of interval variables is created.</p>
<div id="cell-11" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_types <span class="op">=</span> {<span class="st">'severity'</span>: <span class="st">'interval'</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">'driver_age'</span>:<span class="st">'interval'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">'satisfaction'</span>:<span class="st">'ordinal'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">'mileage'</span>:<span class="st">'interval'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">'car_size'</span>:<span class="st">'ordinal'</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">'car_use'</span>:<span class="st">'ordinal'</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">'car_color'</span>:<span class="st">'categorical'</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">'area'</span>:<span class="st">'categorical'</span>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>interval_cols <span class="op">=</span> [col <span class="cf">for</span> col, v <span class="kw">in</span> data_types.items() <span class="cf">if</span> v<span class="op">==</span><span class="st">'interval'</span> <span class="kw">and</span> col <span class="kw">in</span> data.columns]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>interval_cols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>['driver_age', 'mileage']</code></pre>
</div>
</div>
</section>
<section id="visually-inspect-pairwise-correlations" class="level1">
<h1>Visually inspect pairwise correlations</h1>
<section id="bin-the-interval-variables" class="level2">
<h2 class="anchored" data-anchor-id="bin-the-interval-variables">Bin the interval variables</h2>
<p>To get a feeling for the data, let’s bin the interval variables and create 2d histograms to inspect the correlations between variables. By binning the interval variables we can treat all variable types in the same way.</p>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bin the interval variables</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_binned, binning_dict <span class="op">=</span> bin_data(data, cols<span class="op">=</span>interval_cols, retbins<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-15" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>binning_dict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>{'driver_age': [(18.030700817879673, 28.34523864121504),
  (28.34523864121504, 38.659776464550404),
  (38.659776464550404, 48.974314287885775),
  (48.974314287885775, 59.288852111221146),
  (59.288852111221146, 69.60338993455652),
  (69.60338993455652, 79.91792775789187),
  (79.91792775789187, 90.23246558122725),
  (90.23246558122725, 100.54700340456262),
  (100.54700340456262, 110.86154122789799),
  (110.86154122789799, 121.17607905123334)],
 'mileage': [(53.54305708442213, 30047.010932306846),
  (30047.010932306846, 60040.478807529274),
  (60040.478807529274, 90033.94668275169),
  (90033.94668275169, 120027.41455797412),
  (120027.41455797412, 150020.88243319656),
  (150020.88243319656, 180014.35030841897),
  (180014.35030841897, 210007.81818364142),
  (210007.81818364142, 240001.28605886383),
  (240001.28605886383, 269994.75393408624),
  (269994.75393408624, 299988.2218093087)]}</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot each variable pair</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.rc(<span class="st">'text'</span>, usetex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>n<span class="op">=</span><span class="dv">0</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(data.columns)):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    n<span class="op">=</span>n<span class="op">+</span>i</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>ncols<span class="op">=</span><span class="dv">3</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>nrows<span class="op">=</span><span class="bu">int</span>(np.ceil(n<span class="op">/</span>ncols))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows, ncols, figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">4</span><span class="op">*</span>nrows))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>ndecimals <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, comb <span class="kw">in</span> <span class="bu">enumerate</span>(itertools.combinations(data_binned.columns.values, <span class="dv">2</span>)):</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="bu">int</span>(i<span class="op">%</span>ncols)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="bu">int</span>((i<span class="op">-</span>c)<span class="op">/</span>ncols )</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get data</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    c0, c1 <span class="op">=</span> comb</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    datahist <span class="op">=</span> data_binned.groupby([c0,c1])[c0].count().to_frame().unstack().fillna(<span class="dv">0</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    datahist.columns <span class="op">=</span> datahist.columns.droplevel()</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot data</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> axes[r][c].pcolormesh(datahist.values, edgecolor<span class="op">=</span><span class="st">'w'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># axis ticks and tick labels</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> c0 <span class="kw">in</span> binning_dict.keys():</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        ylabels <span class="op">=</span> [<span class="st">'{1:.</span><span class="sc">{0}</span><span class="st">f}_{2:.</span><span class="sc">{0}</span><span class="st">f}'</span>.<span class="bu">format</span>(ndecimals, binning_dict[c0][i][<span class="dv">0</span>], binning_dict[c0][i][<span class="dv">1</span>])</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(binning_dict[c0]))]</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        ylabels <span class="op">=</span> datahist.index</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> c1 <span class="kw">in</span> binning_dict.keys():        </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        xlabels <span class="op">=</span> [<span class="st">'{1:.</span><span class="sc">{0}</span><span class="st">f}_{2:.</span><span class="sc">{0}</span><span class="st">f}'</span>.<span class="bu">format</span>(ndecimals, binning_dict[c1][i][<span class="dv">0</span>], binning_dict[c1][i][<span class="dv">1</span>])</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(binning_dict[c1]))]</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        xlabels <span class="op">=</span> datahist.columns</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># axis labels</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    axes[r][c].set_yticks(np.arange(<span class="bu">len</span>(ylabels)) <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    axes[r][c].set_xticks(np.arange(<span class="bu">len</span>(xlabels)) <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    axes[r][c].set_xticklabels(xlabels, rotation<span class="op">=</span><span class="st">'vertical'</span>)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    axes[r][c].set_yticklabels(ylabels, rotation<span class="op">=</span><span class="st">'horizontal'</span>)    </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    axes[r][c].set_xlabel(datahist.columns.name)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    axes[r][c].set_ylabel(datahist.index.name)    </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    axes[r][c].set_title(<span class="st">'data'</span>)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="correlation-mileage-vs-car_size" class="level1">
<h1>Correlation: mileage vs car_size</h1>
<p>From the above plots it seems like there might be an interesting a correlation between mileage and car_size. Let’s see what phik correlation is measured for this data.</p>
<div id="cell-18" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> data[[<span class="st">'mileage'</span>, <span class="st">'car_size'</span>]].T.values</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'phik         =  </span><span class="sc">%.2f</span><span class="st">'</span><span class="op">%</span>phik.phik_from_array(x, y, num_vars<span class="op">=</span>[<span class="st">'x'</span>]))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'significance = </span><span class="sc">%.2f</span><span class="st">'</span><span class="op">%</span>phik.significance_from_array(x, y, num_vars<span class="op">=</span>[<span class="st">'x'</span>])[<span class="dv">1</span>])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>phik         =  0.77
significance = 49.22</code></pre>
</div>
</div>
<p>Indeed there is a correlation between these variables and the correlation is also significant. To better understand the correlation, we can have a look at the significance of excesses and deficits in the 2-dimensional contingency table, so-called “outlier significances”.</p>
<div id="cell-20" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>phik.outlier_significance_from_array(x, y, num_vars<span class="op">=</span>[<span class="st">'x'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">L</th>
<th data-quarto-table-cell-role="th">M</th>
<th data-quarto-table-cell-role="th">S</th>
<th data-quarto-table-cell-role="th">XL</th>
<th data-quarto-table-cell-role="th">XS</th>
<th data-quarto-table-cell-role="th">XXL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">53.5_30047.0</td>
<td>6.882155</td>
<td>21.483476</td>
<td>18.076204</td>
<td>-8.209536</td>
<td>10.820863</td>
<td>-22.423985</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30047.0_60040.5</td>
<td>20.034528</td>
<td>-0.251737</td>
<td>-3.408409</td>
<td>2.534277</td>
<td>-1.973628</td>
<td>-8.209536</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60040.5_90033.9</td>
<td>1.627610</td>
<td>-3.043497</td>
<td>-2.265809</td>
<td>10.215936</td>
<td>-1.246784</td>
<td>-8.209536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90033.9_120027.4</td>
<td>-3.711579</td>
<td>-3.827278</td>
<td>-2.885475</td>
<td>12.999048</td>
<td>-1.638288</td>
<td>-7.185622</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">120027.4_150020.9</td>
<td>-7.665861</td>
<td>-6.173001</td>
<td>-4.746762</td>
<td>9.629145</td>
<td>-2.841508</td>
<td>-0.504521</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">150020.9_180014.4</td>
<td>-7.533189</td>
<td>-6.063786</td>
<td>-4.660049</td>
<td>1.559370</td>
<td>-2.785049</td>
<td>6.765549</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">180014.4_210007.8</td>
<td>-5.541940</td>
<td>-4.425929</td>
<td>-3.360023</td>
<td>-4.802787</td>
<td>-1.942469</td>
<td>10.520540</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">210007.8_240001.3</td>
<td>-3.496905</td>
<td>-2.745103</td>
<td>-2.030802</td>
<td>-5.850529</td>
<td>-1.100873</td>
<td>8.723925</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">240001.3_269994.8</td>
<td>-5.275976</td>
<td>-4.207164</td>
<td>-3.186534</td>
<td>-8.616464</td>
<td>-1.830944</td>
<td>13.303101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">269994.8_299988.2</td>
<td>-8.014016</td>
<td>-6.458253</td>
<td>-4.973240</td>
<td>-12.868389</td>
<td>-2.989055</td>
<td>20.992824</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The values displayed in the matrix are the significances of the outlier frequencies, i.e.&nbsp;a large value means that the measured frequency for that bin is significantly different from the expected frequency in that bin.</p>
<p>Let’s visualise for easier interpretation.</p>
<div id="cell-22" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>outlier_signifs <span class="op">=</span> phik.outlier_significance_from_array(x, y, num_vars<span class="op">=</span>[<span class="st">'x'</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>zvalues <span class="op">=</span> outlier_signifs.values</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>xlabels <span class="op">=</span> outlier_signifs.columns</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>ylabels <span class="op">=</span> outlier_signifs.index</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="st">'x'</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> <span class="st">'y'</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plot_correlation_matrix(zvalues, x_labels<span class="op">=</span>xlabels, y_labels<span class="op">=</span>ylabels, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                        x_label<span class="op">=</span>xlabel,y_label<span class="op">=</span>ylabel,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                        vmin<span class="op">=-</span><span class="dv">5</span>, vmax<span class="op">=</span><span class="dv">5</span>, title<span class="op">=</span><span class="st">'outlier significance'</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                        identity_layout<span class="op">=</span><span class="va">False</span>, fontsize_factor<span class="op">=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="phi_k-functions-for-dataframes" class="level1">
<h1><span class="math inline">\(\phi_k\)</span> functions for dataframes</h1>
<p>In our data we have 5 different columns, meaning we have to evaluate 4+3+2+1=10 pairs of variables for possible correlations. In a large dataset, with many different variables, this can easily become a cumbersome task. Can we do this more efficient? yes! We have provided functions that work on dataframes, to allow you to calculate the phik correlation, significance and outlier significance for all different variable combinations at once.</p>
<p>The functions are by default available after import of the phik package.</p>
</section>
<section id="phi_k-correlation-matrix" class="level1">
<h1><span class="math inline">\(\phi_k\)</span> correlation matrix</h1>
<p>Now let’s start calculating the phik correlation coefficient between pairs of variables.</p>
<p>Note that the original dataset is used as input, the binning of interval variables is done automatically.</p>
<div id="cell-26" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>phik_overview <span class="op">=</span> data.phik_matrix(interval_cols<span class="op">=</span>interval_cols)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>phik_overview</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th">driver_age</th>
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th">mileage</th>
<th data-quarto-table-cell-role="th">car_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_color</td>
<td>1.000000</td>
<td>0.389671</td>
<td>0.590456</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">driver_age</td>
<td>0.389671</td>
<td>1.000000</td>
<td>0.105506</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">area</td>
<td>0.590456</td>
<td>0.105506</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mileage</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.768589</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_size</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.768589</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>When no interval columns are provided, the code makes an educated guess</p>
<div id="cell-28" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data.phik_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['driver_age', 'mileage']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th">driver_age</th>
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th">mileage</th>
<th data-quarto-table-cell-role="th">car_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_color</td>
<td>1.000000</td>
<td>0.389671</td>
<td>0.590456</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">driver_age</td>
<td>0.389671</td>
<td>1.000000</td>
<td>0.105506</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">area</td>
<td>0.590456</td>
<td>0.105506</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mileage</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.768589</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_size</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.768589</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_correlation_matrix(phik_overview.values, x_labels<span class="op">=</span>phik_overview.columns, y_labels<span class="op">=</span>phik_overview.index, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                        vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">1</span>, color_map<span class="op">=</span><span class="st">'Blues'</span>, title<span class="op">=</span><span class="vs">r'correlation $\phi_K$'</span>, fontsize_factor<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                        figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="fl">5.5</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="global-correlation-g_k" class="level1">
<h1>Global correlation: <span class="math inline">\(g_k\)</span></h1>
<p>The global correlation coefficient is a measure of the total correlation of one variable to all other variables in the dataset. They give an indication of how well on variable can be modelled in terms of the other variables. A calculation of the global correlation coefficient is provided within the phik package.</p>
<div id="cell-31" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>global_correlation, global_labels <span class="op">=</span> data.global_phik(interval_cols<span class="op">=</span>interval_cols)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c, l <span class="kw">in</span> <span class="bu">zip</span>(global_correlation, global_labels):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(l, c[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>car_color 0.6760316805291614
driver_age 0.41913014836289686
area 0.6057526929030086
mileage 0.7685888294891848
car_size 0.7685888294891848</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_correlation_matrix(global_correlation, x_labels<span class="op">=</span>[<span class="st">''</span>], y_labels<span class="op">=</span>global_labels, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                        vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="fl">3.5</span>,<span class="dv">4</span>),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                        color_map<span class="op">=</span><span class="st">'Blues'</span>, title<span class="op">=</span><span class="vs">r'$g_k$'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                        fontsize_factor<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="statistical-significance-of-the-correlation-z-score" class="level1">
<h1>Statistical significance of the correlation: <span class="math inline">\(Z\)</span>-score</h1>
<p>When assessing correlations it is good practise to evaluate both the correlation and the significance of the correlation: a large correlation may be statistically insignificant, and vice versa a small correlation may be very significant. For instance, scipy.stats.pearsonr returns both the pearson correlation and the p-value. Similarly, the phik package offers functionality the calculate a significance matrix. Significance is defined as:</p>
<p><span class="math display">\[Z = \Phi^{-1}(1-p)\ ;\quad \Phi(z)=\frac{1}{\sqrt{2\pi}} \int_{-\infty}^{z} e^{-t^{2}/2}\,{\rm d}t \]</span></p>
<p>Several corrections to the ‘standard’ p-value calculation are taken into account, making the method more robust for low statistics and sparse data cases. The user is referred to our paper for more details.</p>
<p>As a result, the calculation may take a few seconds.</p>
<div id="cell-34" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>significance_overview <span class="op">=</span> data.significance_matrix(interval_cols<span class="op">=</span>interval_cols)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>significance_overview</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th">driver_age</th>
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th">mileage</th>
<th data-quarto-table-cell-role="th">car_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_color</td>
<td>85.454073</td>
<td>19.839441</td>
<td>37.584186</td>
<td>-0.622065</td>
<td>-0.620222</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">driver_age</td>
<td>19.839441</td>
<td>84.331822</td>
<td>1.814443</td>
<td>-0.679303</td>
<td>-0.509666</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">area</td>
<td>37.584186</td>
<td>1.814443</td>
<td>72.420956</td>
<td>-0.666399</td>
<td>-0.361338</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mileage</td>
<td>-0.622065</td>
<td>-0.679303</td>
<td>-0.666399</td>
<td>91.229648</td>
<td>49.233473</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_size</td>
<td>-0.620222</td>
<td>-0.509666</td>
<td>-0.361338</td>
<td>49.233473</td>
<td>69.041094</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plot_correlation_matrix(significance_overview.fillna(<span class="dv">0</span>).values, x_labels<span class="op">=</span>significance_overview.columns, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                        y_labels<span class="op">=</span>significance_overview.index, vmin<span class="op">=-</span><span class="dv">5</span>, vmax<span class="op">=</span><span class="dv">5</span>, title<span class="op">=</span><span class="st">'significance'</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                        usetex<span class="op">=</span><span class="va">False</span>, fontsize_factor<span class="op">=</span><span class="fl">1.5</span>, figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="fl">5.5</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="outlier-significance" class="level1">
<h1>Outlier significance</h1>
<p>The normal pearson correlation between two interval variables is easy to interpret. However, the phik correlation between two variables of mixed type is not always easy to interpret, especially when it concerns categorical variables. Therefore, functionality is provided to detect “outliers”: excesses and deficits over the expected frequencies in the contingency table of two variables.</p>
<section id="example-1-car_color-versus-area" class="level3">
<h3 class="anchored" data-anchor-id="example-1-car_color-versus-area">Example 1: car_color versus area</h3>
<p>For the categorical variable pair car_color - area we measured:</p>
<p><span class="math display">\[\phi_k = 0.59 \, ,\quad\quad \mathrm{significance} = 37.6\]</span></p>
<p>Let’s use the outlier significance functionality to gain a better understanding of the significance correlation between car color and area.</p>
<div id="cell-38" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="op">=</span> <span class="st">'car_color'</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>c0 <span class="op">=</span> <span class="st">'area'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-39" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>outlier_signifs, binning_dict <span class="op">=</span> data[[c0,c1]].outlier_significance_matrix(retbins<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>outlier_signifs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th">black</th>
<th data-quarto-table-cell-role="th">blue</th>
<th data-quarto-table-cell-role="th">gray</th>
<th data-quarto-table-cell-role="th">green</th>
<th data-quarto-table-cell-role="th">metalic</th>
<th data-quarto-table-cell-role="th">multicolor</th>
<th data-quarto-table-cell-role="th">red</th>
<th data-quarto-table-cell-role="th">white</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">country_side</td>
<td>-5.636485</td>
<td>-5.277175</td>
<td>-1.688032</td>
<td>5.824664</td>
<td>6.506020</td>
<td>0.092630</td>
<td>-2.282290</td>
<td>-1.193468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">downtown</td>
<td>-16.444319</td>
<td>-8.209536</td>
<td>3.450521</td>
<td>14.176441</td>
<td>12.238785</td>
<td>2.582260</td>
<td>-3.863796</td>
<td>-4.400847</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">hills</td>
<td>-8.209536</td>
<td>3.054306</td>
<td>9.244711</td>
<td>-2.097600</td>
<td>-3.022553</td>
<td>4.789665</td>
<td>2.695864</td>
<td>-1.092375</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">suburbs</td>
<td>19.533221</td>
<td>8.315558</td>
<td>-8.209536</td>
<td>-8.209536</td>
<td>-8.209536</td>
<td>-6.529846</td>
<td>1.667814</td>
<td>3.964555</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">unpaved_roads</td>
<td>13.043553</td>
<td>-1.776804</td>
<td>-6.095289</td>
<td>-5.532779</td>
<td>-4.566500</td>
<td>-3.829519</td>
<td>-1.339881</td>
<td>1.074386</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>zvalues <span class="op">=</span> outlier_signifs.values</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>xlabels <span class="op">=</span> binning_dict[c1] <span class="cf">if</span> c1 <span class="kw">in</span> binning_dict.keys() <span class="cf">else</span> outlier_signifs.columns</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ylabels <span class="op">=</span> binning_dict[c0] <span class="cf">if</span> c0 <span class="kw">in</span> binning_dict.keys() <span class="cf">else</span> outlier_signifs.index</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> c1</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> c0</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plot_correlation_matrix(zvalues, x_labels<span class="op">=</span>xlabels, y_labels<span class="op">=</span>ylabels, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                        x_label<span class="op">=</span>xlabel,y_label<span class="op">=</span>ylabel,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                        vmin<span class="op">=-</span><span class="dv">5</span>, vmax<span class="op">=</span><span class="dv">5</span>, title<span class="op">=</span><span class="st">'outlier significance'</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                        identity_layout<span class="op">=</span><span class="va">False</span>, fontsize_factor<span class="op">=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The significance of each cell is expressed in terms of Z (one-sided).</p>
<p>Interesting, owners of a green car are more likely to live in the country side, and black cars are more likely to travel on unpaved roads!</p>
</section>
<section id="example-2-mileage-versus-car_size" class="level3">
<h3 class="anchored" data-anchor-id="example-2-mileage-versus-car_size">Example 2: mileage versus car_size</h3>
<p>For the categorical variable pair mileage - car_size we measured:</p>
<p><span class="math display">\[\phi_k = 0.77 \, ,\quad\quad \mathrm{significance} = 46.3\]</span></p>
<p>Let’s use the outlier significance functionality to gain a better understanding of this significance correlation between mileage and car size.</p>
<div id="cell-44" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>c0 <span class="op">=</span> <span class="st">'mileage'</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="op">=</span> <span class="st">'car_size'</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>tmp_interval_cols <span class="op">=</span> [<span class="st">'mileage'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>outlier_signifs, binning_dict <span class="op">=</span> data[[c0,c1]].outlier_significance_matrix(interval_cols<span class="op">=</span>tmp_interval_cols, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                                                                          retbins<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>outlier_signifs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">car_size</th>
<th data-quarto-table-cell-role="th">L</th>
<th data-quarto-table-cell-role="th">M</th>
<th data-quarto-table-cell-role="th">S</th>
<th data-quarto-table-cell-role="th">XL</th>
<th data-quarto-table-cell-role="th">XS</th>
<th data-quarto-table-cell-role="th">XXL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">53.5_30047.0</td>
<td>6.882155</td>
<td>21.483476</td>
<td>18.076204</td>
<td>-8.209536</td>
<td>10.820863</td>
<td>-22.423985</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30047.0_60040.5</td>
<td>20.034528</td>
<td>-0.251737</td>
<td>-3.408409</td>
<td>2.534277</td>
<td>-1.973628</td>
<td>-8.209536</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">60040.5_90033.9</td>
<td>1.627610</td>
<td>-3.043497</td>
<td>-2.265809</td>
<td>10.215936</td>
<td>-1.246784</td>
<td>-8.209536</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">90033.9_120027.4</td>
<td>-3.711579</td>
<td>-3.827278</td>
<td>-2.885475</td>
<td>12.999048</td>
<td>-1.638288</td>
<td>-7.185622</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">120027.4_150020.9</td>
<td>-7.665861</td>
<td>-6.173001</td>
<td>-4.746762</td>
<td>9.629145</td>
<td>-2.841508</td>
<td>-0.504521</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">150020.9_180014.4</td>
<td>-7.533189</td>
<td>-6.063786</td>
<td>-4.660049</td>
<td>1.559370</td>
<td>-2.785049</td>
<td>6.765549</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">180014.4_210007.8</td>
<td>-5.541940</td>
<td>-4.425929</td>
<td>-3.360023</td>
<td>-4.802787</td>
<td>-1.942469</td>
<td>10.520540</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">210007.8_240001.3</td>
<td>-3.496905</td>
<td>-2.745103</td>
<td>-2.030802</td>
<td>-5.850529</td>
<td>-1.100873</td>
<td>8.723925</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">240001.3_269994.8</td>
<td>-5.275976</td>
<td>-4.207164</td>
<td>-3.186534</td>
<td>-8.616464</td>
<td>-1.830944</td>
<td>13.303101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">269994.8_299988.2</td>
<td>-8.014016</td>
<td>-6.458253</td>
<td>-4.973240</td>
<td>-12.868389</td>
<td>-2.989055</td>
<td>20.992824</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that the interval variable mileage is binned automatically in 10 uniformly spaced bins!</p>
<div id="cell-47" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>zvalues <span class="op">=</span> outlier_signifs.values</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>xlabels <span class="op">=</span> outlier_signifs.columns</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ylabels <span class="op">=</span> outlier_signifs.index</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> c1</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> c0</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plot_correlation_matrix(zvalues, x_labels<span class="op">=</span>xlabels, y_labels<span class="op">=</span>ylabels, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                        x_label<span class="op">=</span>xlabel,y_label<span class="op">=</span>ylabel,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                        vmin<span class="op">=-</span><span class="dv">5</span>, vmax<span class="op">=</span><span class="dv">5</span>, title<span class="op">=</span><span class="st">'outlier significance'</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                        identity_layout<span class="op">=</span><span class="va">False</span>, fontsize_factor<span class="op">=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="correlation-report" class="level1">
<h1>Correlation report</h1>
<p>A full correlation report can be created automatically for a dataset by pairwise evaluation of all correlations, significances and outlier significances.</p>
<p>Note that for a dataset with many different columns the number of outlier significances plots can grow large very rapidly. Therefore, the feature is implemented to only evaluate outlier significances for those variable pairs with a significance and correlation larger than the given thresholds.</p>
<div id="cell-50" class="cell" data-scrolled="false" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> phik <span class="im">import</span> report</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>rep <span class="op">=</span> report.correlation_report(data, significance_threshold<span class="op">=</span><span class="dv">3</span>, correlation_threshold<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['driver_age', 'mileage']</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-27-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-27-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-27-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-27-output-5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="phik_tutorial_basic_files/figure-html/cell-27-output-6.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="recap" class="level1">
<h1>Recap</h1>
<p>To summarize, the main functions in the phik correlation package working on a dataframe are:</p>
<ul>
<li><code>df[twocols].hist2d()</code> or <code>series.hist2d(other_series)</code></li>
<li><code>df.phik_matrix()</code></li>
<li><code>df.global_phik()</code></li>
<li><code>df.significance_matrix()</code></li>
<li><code>df[twocols].outlier_significance_matrix()</code> or <code>series.hist2d(other_series)</code></li>
<li><code>df.outlier_significance_matrices()</code></li>
</ul>
<div id="cell-53" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data[[<span class="st">'driver_age'</span>, <span class="st">'mileage'</span>]].hist2d()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively: data['driver_age'].hist2d(data['mileage'])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['driver_age', 'mileage']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">mileage</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">driver_age</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>54.0</td>
<td>30.0</td>
<td>13.0</td>
<td>29.0</td>
<td>57.0</td>
<td>61.0</td>
<td>36.0</td>
<td>11.0</td>
<td>36.0</td>
<td>61.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>51.0</td>
<td>41.0</td>
<td>13.0</td>
<td>17.0</td>
<td>64.0</td>
<td>41.0</td>
<td>35.0</td>
<td>12.0</td>
<td>30.0</td>
<td>75.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>65.0</td>
<td>29.0</td>
<td>21.0</td>
<td>24.0</td>
<td>53.0</td>
<td>54.0</td>
<td>35.0</td>
<td>14.0</td>
<td>27.0</td>
<td>66.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>49.0</td>
<td>23.0</td>
<td>17.0</td>
<td>30.0</td>
<td>50.0</td>
<td>54.0</td>
<td>21.0</td>
<td>17.0</td>
<td>25.0</td>
<td>53.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>41.0</td>
<td>28.0</td>
<td>19.0</td>
<td>15.0</td>
<td>33.0</td>
<td>45.0</td>
<td>27.0</td>
<td>11.0</td>
<td>23.0</td>
<td>39.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>21.0</td>
<td>12.0</td>
<td>5.0</td>
<td>12.0</td>
<td>26.0</td>
<td>25.0</td>
<td>10.0</td>
<td>8.0</td>
<td>10.0</td>
<td>15.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>7.0</td>
<td>8.0</td>
<td>2.0</td>
<td>3.0</td>
<td>8.0</td>
<td>9.0</td>
<td>4.0</td>
<td>2.0</td>
<td>3.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>5.0</td>
<td>2.0</td>
<td>0.0</td>
<td>1.0</td>
<td>6.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>1.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data.phik_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['driver_age', 'mileage']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th">driver_age</th>
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th">mileage</th>
<th data-quarto-table-cell-role="th">car_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_color</td>
<td>1.000000</td>
<td>0.389671</td>
<td>0.590456</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">driver_age</td>
<td>0.389671</td>
<td>1.000000</td>
<td>0.105506</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">area</td>
<td>0.590456</td>
<td>0.105506</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mileage</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.768589</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_size</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.768589</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>data.global_phik()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['driver_age', 'mileage']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>(array([[0.67603168],
        [0.41913015],
        [0.60575269],
        [0.76858883],
        [0.76858883]]),
 array(['car_color', 'driver_age', 'area', 'mileage', 'car_size'],
       dtype=object))</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data.significance_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['driver_age', 'mileage']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th">driver_age</th>
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th">mileage</th>
<th data-quarto-table-cell-role="th">car_size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_color</td>
<td>85.468302</td>
<td>19.787607</td>
<td>37.609394</td>
<td>-0.634132</td>
<td>-0.586560</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">driver_age</td>
<td>19.787607</td>
<td>84.314315</td>
<td>1.857272</td>
<td>-0.586955</td>
<td>-0.532817</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">area</td>
<td>37.609394</td>
<td>1.857272</td>
<td>72.400210</td>
<td>-0.593527</td>
<td>-0.334542</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mileage</td>
<td>-0.634132</td>
<td>-0.586955</td>
<td>-0.593527</td>
<td>91.221584</td>
<td>49.249503</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">car_size</td>
<td>-0.586560</td>
<td>-0.532817</td>
<td>-0.334542</td>
<td>49.249503</td>
<td>69.047125</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-57" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>data[[<span class="st">'area'</span>, <span class="st">'mileage'</span>]].outlier_significance_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['mileage']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">53.5_30047.0</th>
<th data-quarto-table-cell-role="th">30047.0_60040.5</th>
<th data-quarto-table-cell-role="th">60040.5_90033.9</th>
<th data-quarto-table-cell-role="th">90033.9_120027.4</th>
<th data-quarto-table-cell-role="th">120027.4_150020.9</th>
<th data-quarto-table-cell-role="th">150020.9_180014.4</th>
<th data-quarto-table-cell-role="th">180014.4_210007.8</th>
<th data-quarto-table-cell-role="th">210007.8_240001.3</th>
<th data-quarto-table-cell-role="th">240001.3_269994.8</th>
<th data-quarto-table-cell-role="th">269994.8_299988.2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">area</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">country_side</td>
<td>-0.178204</td>
<td>0.192584</td>
<td>0.099073</td>
<td>-1.818924</td>
<td>0.103907</td>
<td>0.888225</td>
<td>0.251480</td>
<td>1.491532</td>
<td>0.016080</td>
<td>-0.869129</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">downtown</td>
<td>0.625586</td>
<td>-2.141106</td>
<td>0.541785</td>
<td>0.931452</td>
<td>-0.926177</td>
<td>0.582585</td>
<td>0.917301</td>
<td>-0.729204</td>
<td>-0.978248</td>
<td>0.610302</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">hills</td>
<td>-0.826807</td>
<td>1.346029</td>
<td>-0.841090</td>
<td>0.008498</td>
<td>0.071356</td>
<td>1.028940</td>
<td>0.107051</td>
<td>0.080217</td>
<td>-0.397630</td>
<td>-0.904236</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">suburbs</td>
<td>0.972621</td>
<td>0.098196</td>
<td>0.712079</td>
<td>-0.059975</td>
<td>0.975536</td>
<td>-1.759184</td>
<td>-0.716170</td>
<td>-0.603623</td>
<td>0.059615</td>
<td>-0.050745</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">unpaved_roads</td>
<td>-1.469438</td>
<td>0.518041</td>
<td>-0.915745</td>
<td>-0.475005</td>
<td>-0.679357</td>
<td>-0.545607</td>
<td>-0.808321</td>
<td>0.901333</td>
<td>2.175620</td>
<td>1.339934</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-58" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>os_matrices <span class="op">=</span> data.outlier_significance_matrices()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>interval columns not set, guessing: ['driver_age', 'mileage']</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>os_matrices.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>dict_keys(['car_color:driver_age', 'car_color:area', 'car_color:mileage', 'car_color:car_size', 'driver_age:area', 'driver_age:mileage', 'driver_age:car_size', 'area:mileage', 'area:car_size', 'mileage:car_size'])</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>os_matrices[<span class="st">'car_color:mileage'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">53.5_30047.0</th>
<th data-quarto-table-cell-role="th">30047.0_60040.5</th>
<th data-quarto-table-cell-role="th">60040.5_90033.9</th>
<th data-quarto-table-cell-role="th">90033.9_120027.4</th>
<th data-quarto-table-cell-role="th">120027.4_150020.9</th>
<th data-quarto-table-cell-role="th">150020.9_180014.4</th>
<th data-quarto-table-cell-role="th">180014.4_210007.8</th>
<th data-quarto-table-cell-role="th">210007.8_240001.3</th>
<th data-quarto-table-cell-role="th">240001.3_269994.8</th>
<th data-quarto-table-cell-role="th">269994.8_299988.2</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">car_color</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">black</td>
<td>0.366425</td>
<td>1.387093</td>
<td>-1.320194</td>
<td>-1.274558</td>
<td>1.908010</td>
<td>-0.880578</td>
<td>-1.260293</td>
<td>-0.498607</td>
<td>-0.449794</td>
<td>0.492858</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">blue</td>
<td>-0.409760</td>
<td>-1.676495</td>
<td>-0.515491</td>
<td>1.969650</td>
<td>0.474818</td>
<td>-1.260466</td>
<td>-0.505987</td>
<td>-0.575699</td>
<td>1.675451</td>
<td>0.601026</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gray</td>
<td>0.267888</td>
<td>-0.338430</td>
<td>-1.148378</td>
<td>0.048682</td>
<td>-0.238285</td>
<td>1.522769</td>
<td>1.282298</td>
<td>-0.812279</td>
<td>-0.589854</td>
<td>-0.887127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">green</td>
<td>-0.195906</td>
<td>0.399471</td>
<td>1.306739</td>
<td>-0.918723</td>
<td>0.373229</td>
<td>-0.859866</td>
<td>-0.862544</td>
<td>0.772096</td>
<td>-0.169912</td>
<td>0.471057</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">metalic</td>
<td>0.697184</td>
<td>-0.385806</td>
<td>0.672620</td>
<td>0.205599</td>
<td>-1.543500</td>
<td>1.168147</td>
<td>0.249471</td>
<td>0.513459</td>
<td>-0.174870</td>
<td>-0.952009</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">multicolor</td>
<td>-0.478862</td>
<td>-0.591987</td>
<td>0.893783</td>
<td>0.050843</td>
<td>-2.104857</td>
<td>0.994621</td>
<td>0.109020</td>
<td>0.578461</td>
<td>-0.506460</td>
<td>1.287415</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">red</td>
<td>-0.551106</td>
<td>0.548949</td>
<td>1.370043</td>
<td>-0.050064</td>
<td>-1.822748</td>
<td>0.055521</td>
<td>2.208175</td>
<td>0.921955</td>
<td>0.219336</td>
<td>-1.556492</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">white</td>
<td>-0.055025</td>
<td>1.219026</td>
<td>-0.596627</td>
<td>-0.427730</td>
<td>1.888206</td>
<td>-0.471175</td>
<td>-0.851352</td>
<td>-0.393054</td>
<td>-0.697834</td>
<td>-0.323899</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>